# -- Read the MODFLOW 6 GRB file.

cl_mf6 = read_mf6_grid_specs(file=model.dis.grb,        &
                             dimensions=3,              &
                             slist_layernum = layer)

# -- Read the pilot points file to define a pilot points CLIST and
#    to obtain K values at all pilot points in all layers.

cl_pp = read_list_file(file='pp.dat',              &
                       skiplines=1,                &
                       dimensions=2,               &
                       id_type='character',        &
                       plist='pp_k1';column=4,     &
                       plist='pp_k2';column=5,     &
                       plist='pp_k3';column=6,     &
                       plist='pp_k4';column=7)

# -- Calculate kriging factors from the pilot points to the grid.

calc_kriging_factors_auto_2d(target_clist=cl_mf6;select=(layer==1),      &
                             source_clist=cl_pp,                         &
                             file=factors_lay1.dat;format=binary)

calc_kriging_factors_auto_2d(target_clist=cl_mf6;select=(layer==2),      &
                             source_clist=cl_pp,                         &
                             file=factors_lay2.dat;format=binary)

calc_kriging_factors_auto_2d(target_clist=cl_mf6;select=(layer==3),      &
                             source_clist=cl_pp,                         &
                             file=factors_lay3.dat;format=binary)

calc_kriging_factors_auto_2d(target_clist=cl_mf6;select=(layer==4),      &
                             source_clist=cl_pp,                         &
                             file=factors_lay4.dat;format=binary)

# -- The MF6 k array PLIST is now defined.

mf6_k=new_plist(reference_clist=cl_mf6,value=1.0)

# -- Interpolation to the MF6 grid is now carried out.

mf6_k=pp_k1.krige_using_file(file='factors_lay1.dat';form='binary',     &
                              transform='log')

mf6_k=pp_k2.krige_using_file(file='factors_lay2.dat';form='binary',     &
                              transform='log')

mf6_k=pp_k3.krige_using_file(file='factors_lay3.dat';form='binary',     &
                              transform='log')

mf6_k=pp_k4.krige_using_file(file='factors_lay4.dat';form='binary',     &
                              transform='log')

# -- The file holding the MODFLOW K array is written.

write_model_input_file(template_file='k.txt.tpl',      &
                       model_input_file= 'k.txt')

# -- The following function populates another file with K values. The
#    MF62VTK utility will read this file. MF62VTK requires that columns
#    of numbers possess headers.

write_model_input_file(template_file='k_for_pictures.txt.tpl',      &
                       model_input_file= 'k_for_pictures.txt')

